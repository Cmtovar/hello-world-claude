# Development Session: 2026-01-29

**Summary:** Major game systems design session. Shifted from movement mechanics implementation to comprehensive tactical game system architecture and first map narrative design.

---

## Session Overview

### What We Accomplished
1. **Explored entire game system architecture** through collaborative discussion
2. **Designed 6 major interconnected systems** (blueprint mode, templates, constraints, progression, techniques, IDE)
3. **Created complete narrative framework** for first map
4. **Established documentation patterns** for multi-session development

### Session Flow
1. Started with discussion about project goals
2. Naturally explored constraint interface pattern
3. Discovered blueprint mode (AP + parallel coordination)
4. Designed template composition system
5. Established progression philosophy (unit-based, not tool-based)
6. Explored techniques and environmental interaction
7. Designed almanac and template IDE
8. Shifted to concrete map design
9. Created complete narrative for first map

---

## Major Systems Designed

### 1. Constraint Interface Pattern
**File:** `concepts/CONSTRAINT-INTERFACE-PATTERN.md`

**Core Concept:**
- Constraints are interface signatures for spatial interaction
- Objects with matching constraint signatures are interchangeable
- Maps specify required interfaces, not specific objects
- Enables level design through composition

**Three Use Cases:**
1. Test validation (current)
2. Level design patterns (intended)
3. Gameplay mechanics (emergent - status effects, terrain)

**Key Example:**
- Throne with directional constraints (sittable from front, blocking from sides)

**Impact:**
- Modular level design
- Object interchangeability
- Emergent affordances

---

### 2. Blueprint Mode System
**Files:**
- `concepts/blueprint-mode-design.md` (primary source)
- `concepts/blueprint-mode-interpretation.md` (analysis)

**Core Mechanics:**
- AP regeneration system (units fill to 100% before acting)
- Can only act at 100% AP
- Blueprint mode: time-frozen planning state
- Plan parallel actions for multiple units
- Execute simultaneously

**Key Innovation:**
- True parallelism (vs Fire Emblem's sequential turns)
- Inverted Splatoon ink mechanic (charge to act, then spend all)
- Coordination as primary strategic element

**Anti-Turtle Design:**
- Need "arteries" for unit flow
- Space becomes a resource
- Mob enemies coordinate too

**Trade-off:**
- Wait for multiple units = more coordination
- Act immediately = faster response, less coordination

---

### 3. Template Composition System
**Files:**
- `concepts/template-composition-system.md` (primary source)
- `concepts/template-composition-interpretation.md` (analysis)

**Core Concept:**
- Templates are composable functions for tactics
- Control flow (if/else, optional branches)
- Templates can call other templates (nested composition)
- Idempotent (work standalone or as components)

**Two UI Contexts:**

**In-Battle (Blueprint Mode):**
- Quick access to saved templates
- Fast execution under pressure
- Minimal detail, maximum speed

**Out-of-Battle (Tactics Hall):**
- Detailed template editor
- Drag-and-drop composition
- No time pressure
- Visual programming for tactics

**Learning System:**
- **Prescriptive:** Pre-built patterns to study
- **Conceptual:** Books teach principles
- **Experiential:** Training grounds for practice

**Progression:**
- Early: 3 slots, no control flow, simple sequences
- Mid: 5 slots, if/else unlocked, composition (1 level deep)
- Late: 10 slots, complex control flow, unlimited composition depth

**Key Insight:**
- Teaching computational thinking through gameplay
- Players build tactical "libraries"
- Expert mastery = elegant template design

---

### 4. Progression Through Units
**Files:**
- `concepts/progression-through-units.md` (primary source)
- `concepts/progression-through-units-interpretation.md` (analysis)

**Core Philosophy:**
> "The player isn't limited, but their units are."

**What's Gated:**
- Unit capabilities (abilities, actions)
- AP regen rates (timing)
- Equipment options (modifiers)
- Unit availability (roster)

**What's NOT Gated:**
- Template design tools (full access from start)
- Creative expression (infinite)
- Strategic knowledge (learn anytime)
- Template library (keep everything)

**Key Example: Child vs Knight**

**Knight:**
- Heavy armor, shield, charge, leadership
- Enables: "Shield Wall", "Knight Charge", "Defensive Formation"

**Child:**
- Light armor, fast movement, distraction, quick step
- Enables: "Scout Forward", "Distraction Tactics"
- DOESN'T enable knight templates (lacks capabilities)

**Result:**
- Natural role differentiation
- Templates create recruitment goals
- No artificial class restrictions

**Learning Flow:**
1. Study enemy actions (action history)
2. Decompose complex patterns
3. See how micro-pieces compose
4. Create templates immediately (even if can't execute)
5. Templates wait in library until right units acquired

---

### 5. Techniques & Environmental Interaction
**Files:**
- `concepts/techniques-and-environment.md` (primary source)
- `concepts/techniques-and-environment-interpretation.md` (analysis)

**Offset System (White Ink Frames):**
- After heavy technique, AP drops to 0%
- Offset period (e.g., 8 seconds) before AP can refill
- Unit cannot act during offset
- Creates vulnerability windows

**Example: Megumin's Explosion**
- Massive AoE damage
- 8 second offset (completely vulnerable)
- Templates must protect during recovery

**Design Shift:**
- Away from: Resource management (weapon durability)
- Toward: Timing management (AP + offset) and spatial tactics

**Minimal Inventory:**
- 2 slots: Primary + Auxiliary
- Equipment swapping mid-battle
- Trading with allies
- Battlefield loot

**Intrinsic Weapon Properties:**
- Some weapons have built-in effects
- Dragon Slayer: Free dragon bonus on every attack
- Trade-off: Worse against non-dragons
- Frees up technique slot

**Environmental Weapons (Most Important):**
- Carnivorous plants (agitate to lunge at enemies)
- Boulders (push down slopes)
- Geysers (trigger for height/damage)
- Destructible walls, creatures, objects as projectiles

**Templates reference environmental objects:**
```
Template: "Plant Trap"
Requirements: Unit with push, Environmental: carnivorous plant
```

---

### 6. Almanac & Template IDE
**Files:**
- `concepts/almanac-and-template-ide.md` (primary source)
- `concepts/almanac-and-template-ide-interpretation.md` (analysis)

**Three Buildings System:**
1. **Tactics Hall** - Template editor/IDE
2. **Strategy Library** - Books, conceptual guides
3. **Almanac** (Piklopedia) - Environmental object catalog

**Almanac Features:**
- Catalog of all environmental objects
- Behavioral data, constraints, triggers
- Interactive demonstrations
- Tactical use suggestions
- "Add to Template IDE" button

**Template IDE Features:**

**Temporal Playback:**
- Step through template execution
- Scrub timeline
- See exact state at any moment
- Debug coordination issues

**Environmental Integration:**
- Drag environmental objects from Almanac
- Place in template context
- Simulate behavior
- Test interactions

**Handler Pattern Creation:**
- Define input/output for environmental interaction
- "Plant Trap" handler becomes reusable component
- Compose handlers into larger templates
- Formal specification with preconditions/postconditions

**Learning Flow:**
1. Encounter environmental asset in battle
2. Study in Almanac (what it does)
3. Read conceptual guide in Library (how to use it)
4. Design handler in Template IDE (create pattern)
5. Save handler as reusable component
6. Compose into larger templates
7. Use in actual battle

**"Save as Template" Button:**
- Watch enemy actions in battle
- Click to export their pattern
- Opens template editor with structure pre-filled
- Literally "view source" for tactics

---

## First Map Complete Narrative Design

**File:** `FIRST-MAP-NARRATIVE.md`

### The Bridge at Old Fort Crossing

**Setting:**
- Rope bridge over small creek/river
- Abandoned military battlement ruins
- 20x20 map, 2-3 elevation levels
- Cool, damp ruins with collapsed towers

**Story:**
- Player is humble mercenary group
- Routine salvage mission to ruins
- Retrieve item for townsfolk
- Unexpected encounter with baby anomaly

**Encounter Sequence:**

**Act 1: Arrival (Peaceful)**
- Cross bridge, explore ruins
- Characters playful, casual
- Free exploration

**Act 2: Startle (Inciting Incident)**
- Baby anomaly startled by presence
- Reflexively stokes rain (like octopus inking)
- Runs away in panic
- Drops item with purple viscous residue

**Act 3: Uprising (Escalation)**
- Rain raises water level
- Submerged zombies revealed in river
- Zombies rise, horde toward group
- Use blueprint mode to escape
- Tactical retreat across bridge

**Act 4: Rescue (Resolution)**
- Alchemist arrives (noticed unexpected rain)
- Tosses flame orb (shatters, burns zombies, clears sky)
- Demonstrates alchemist power
- Group saved

**Act 5: Town (Denouement)**
- Return to town safely
- Characters process differently:
  - Artist draws creature
  - Storytellers go to bar
  - Scholar researches in library
  - Apprentice stays with alchemist
  - Youth plays with cats/children
- Player can explore town
- IDE/Blueprint mode becomes available

**World Questions Raised:**
- What was the anomaly? Baby of what?
- Why did rain not hurt players?
- Was rain life-giving (raised zombies)?
- What is purple substance?
- How did alchemist make flame orb?
- Why is capable alchemist in small town?
- Why did fallen soldiers rise?

**Magic System Introduction:**
- Alchemist = engineer/artificer (imbues artifacts)
- Others use magic more directly
- Multiple approaches to magic
- Both valid paths

**Gameplay Loop Introduced:**
- Combat through crisis (not instructions)
- Blueprint mode learned by necessity
- Town exploration (breather, world-building)
- IDE introduction (review battle, study past missions)
- Memory system (view previous missions as playback)

**Progression Philosophy:**
- Player â‰  making characters capable
- Player = learning to coordinate them
- Characters already capable before player arrived
- Progression scales off units, not player level

**Diegetic Teaching:**
- Alchemist teaches template design
- Library research teaches lore + mechanics
- Bar stories teach observation
- Natural story hooks prevent IDE rabbit-hole

---

## Developer Style Guide

**File:** `DEVELOPER-STYLE-GUIDE.md`

**Created to help future Claude sessions understand working style.**

**Key Patterns Identified:**
- Declarative over imperative
- Emergent over prescribed
- Interface-based thinking
- Systems as tools for future self
- Natural emergence over rigid planning
- Thinking out loud, collaborative exploration
- Comfort with ambiguity and placeholders

**Design Philosophy:**
- Affordances (what's possible in context)
- Composition and interchangeability
- Future-proofing through flexibility
- Separation of concerns (spatial layers)

**Communication Preferences:**
- Let objectives emerge naturally
- Capture insights as we discover them
- Extend ideas, don't just confirm
- Notice patterns and recurring themes

**Red Flags (What to Avoid):**
- Overly rigid systems
- Hardcoded special cases
- Premature optimization
- Implementation before interface

---

## Documentation Created This Session

### Concept Documents (Primary Sources + Interpretations)
1. `CONSTRAINT-INTERFACE-PATTERN.md`
2. `concepts/blueprint-mode-design.md` + interpretation
3. `concepts/template-composition-system.md` + interpretation
4. `concepts/progression-through-units.md` + interpretation
5. `concepts/techniques-and-environment.md` + interpretation
6. `concepts/almanac-and-template-ide.md` + interpretation

### Design Documents
7. `MAP-DESIGN-CONCEPTS.md` - Map design philosophy and rope bridge details
8. `FIRST-MAP-NARRATIVE.md` - Complete narrative framework for first map

### Meta Documents
9. `DEVELOPER-STYLE-GUIDE.md` - Working style patterns for future sessions
10. `SESSION-2026-01-29.md` - This file

### Updates
11. `README.md` - Updated current status section

---

## Key Insights & Patterns

### Anthropological Documentation Approach
- Save user's exact words (primary source)
- Save interpretation alongside (sister document)
- Preserve design intent in version history
- Future sessions can study both

### Systems Thinking Through Immersion
- Game teaches computational thinking
- Open source style learning
- Declarative systems enable inspection
- Players learn meta-patterns, not just tactics

### Emergent Design Process
- Started with constraints discussion
- Naturally led to blueprint mode
- Which led to templates
- Which led to progression philosophy
- Each system informed the next
- Holistic, interconnected design

### Constraint as Foundation
- Everything uses constraint language
- Base terrain, dynamic terrain, units, status effects
- Same interface, different lifetimes
- Enables composition at all levels

---

## Implementation Priority (When Ready)

### Phase 1: Foundation
- [ ] AP regeneration system
- [ ] Blueprint mode UI shell (time-freeze)
- [ ] Single-unit action planning
- [ ] Execute planned actions

### Phase 2: Environment
- [ ] Rope bridge voxel geometry
- [ ] River with rising water
- [ ] Rain weather effect
- [ ] Torch light sources
- [ ] Ruins structure

### Phase 3: Enemies
- [ ] Baby anomaly (triggered behavior)
- [ ] Zombie spawning from water
- [ ] Basic enemy AI (horde toward player)

### Phase 4: Narrative
- [ ] Alchemist cutscene (flame orb)
- [ ] Town layout
- [ ] Character activities
- [ ] Dialogue system

### Phase 5: Learning Systems
- [ ] Template IDE (basic)
- [ ] Almanac (environmental catalog)
- [ ] Memory/replay system

---

## For Next Session

### If Continuing First Map Design:
1. Read `FIRST-MAP-NARRATIVE.md` (complete narrative framework)
2. Read `MAP-DESIGN-CONCEPTS.md` (rope bridge geometry)
3. Begin voxel-by-voxel placement (create `first-map-voxels.json`)
4. Define constraint zones (create `first-map-constraints.json`)

### If Implementing Systems:
1. Review all concept documents in `concepts/` directory
2. Start with AP regeneration (simplest system)
3. Build blueprint mode UI
4. Test with single unit first

### If Exploring New Systems:
1. Read `DEVELOPER-STYLE-GUIDE.md` to understand working approach
2. Start with discussion (let objectives emerge)
3. Capture insights in primary source + interpretation format
4. Build on existing constraint foundation

---

## Git Commit Message (Suggested)

```
Major game systems design session (2026-01-29)

- Designed 6 interconnected systems (blueprint, templates, constraints, etc.)
- Created complete narrative for first map "The Bridge at Old Fort Crossing"
- Established documentation patterns for multi-session development
- Added developer style guide for future Claude sessions

New files:
- CONSTRAINT-INTERFACE-PATTERN.md
- concepts/blueprint-mode-*.md (6 files)
- concepts/template-composition-*.md (2 files)
- concepts/progression-through-units-*.md (2 files)
- concepts/techniques-and-environment-*.md (2 files)
- concepts/almanac-and-template-ide-*.md (2 files)
- MAP-DESIGN-CONCEPTS.md
- FIRST-MAP-NARRATIVE.md
- DEVELOPER-STYLE-GUIDE.md
- SESSION-2026-01-29.md

Updated:
- README.md (current status section)

All systems designed with constraint interface as foundation.
Ready to begin implementation or continue map design.
```

---

**Session Duration:** Extended collaborative design session
**Session Type:** System architecture & narrative design
**Next Milestone:** First complete map implementation OR AP/blueprint system prototype
